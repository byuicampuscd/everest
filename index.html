<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Everest</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.2.5/svg.min.js"></script>
</head>

<body>

    <div id="everest"></div>

    <!--
    Progress Map module from Github repo.
    https://github.com/byuicampuscd/progress-map
    -->

    <script src="./everest/progressMap.js"></script>

    <!--
    The Valence D2L template strings do not work with external script sources.  They need to be internal.
    -->

    <script>

        window.addEventListener('load', function () {

            function loadEverest(pointAccum) {

                var perc = (pointAccum / 29035) * 100;

                progressMap.startup("everest", perc);
            }

            $.getJSON('/d2l/api/le/1.18/{orgUnitId}/grades/values/myGradeValues/', function (grades) {

                var pointAccum = 0,
                    gradeArray = grades;

                for (var i = 0; i < gradeArray.length; i++) {
                    var temp = gradeArray[i].PointsNumerator || 0;
                    pointAccum += temp;
                }

                console.log("Total Points ", pointAccum);
                loadEverest(pointAccum);
            });

        });
    </script>
</body>

</html>
